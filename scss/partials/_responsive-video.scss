// _responsive-video.scss

// Bootstrap 5 breakpoints (pixels)
$bs-breakpoints: (
  sm: 576px,
  md: 768px,
  lg: 992px
);

// Default max-widths for each breakpoint (change these as needed)
$video-max-widths: (
  sm: 100%,     // on small screens take full width
  md: 720px,    // on medium screens cap to 720px
  lg: 1200px     // on large screens cap to 960px
);

// Mixin to output the responsive video container and media queries
// $aspect can be a ratio like 16/9 or a number (e.g. 1.7777)
@mixin responsive-video($aspect: 16/9, $max-widths: $video-max-widths) {
  // wrapper
  .responsive-video {
    position: relative;
    width: 100%;
    margin-left: auto;
    margin-right: auto;
    overflow: hidden;
    background: #000;
    // Use modern aspect-ratio if supported (preferred)
    aspect-ratio: $aspect;
    // Fallback to padding trick for older browsers
    &::before {
      content: "";
      display: block;
      // padding-top = (height/width)*100% -> for 16/9 => 56.25%
      padding-top: (1 / $aspect) * 100%;
      line-height: 0;
      visibility: hidden;
    }

    // inner element that actually contains video/iframe; positioned absolute to fill
    .rv__frame {
      position: absolute;
      inset: 0; // top:0; right:0; bottom:0; left:0;
      display: block;
    }

    // Make video/iframe fill the frame
    video,
    iframe {
      width: 100%;
      height: 100%;
      object-fit: cover; // nice for <video> to maintain cover
      border: 0;
      display: block;
    }

    // Play button overlay
    .rv__play {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background: rgba(0,0,0,0.6);
      border: 2px solid rgba(255,255,255,0.9);
      cursor: pointer;
      z-index: 10;
      transition: transform .12s ease, background .12s ease;
      &:hover, &:focus {
        transform: translate(-50%, -50%) scale(1.06);
        background: rgba(0,0,0,0.75);
        outline: none;
      }
      svg {
        width: 28px;
        height: 28px;
        fill: white;
        display: block;
        margin-left: 4px; // shift to center the triangle visually
      }
    }

    // When .is-playing is present, hide the play button
    &.is-playing .rv__play {
      display: none;
    }

    // Small caption area (optional)
    .rv__caption {
      position: absolute;
      left: 12px;
      bottom: 12px;
      background: rgba(0,0,0,0.45);
      color: #fff;
      padding: 6px 8px;
      font-size: 0.9rem;
      border-radius: 6px;
      z-index: 9;
    }
  }

  // Output media queries for each breakpoint in $bs-breakpoints using $max-widths
  @each $point, $mq in $bs-breakpoints {
    $mw: map-get($max-widths, $point);
    @if $mw {
      @media (min-width: $mq) {
        .responsive-video {
          max-width: $mw;
        }
      }
    }
  }
}

// Use the mixin once (or within a larger partial)
@include responsive-video();
